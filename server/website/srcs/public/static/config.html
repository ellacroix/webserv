<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Configuration</title>
		<!-- <link rel="stylesheet" href="public/css/home.css"> -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
		<link rel="stylesheet" href="/public/css/style.css">

	</head>
	<body>
		<nav class="navbar navbar-expand-sm navbar-fixed-top navbar-dark bg-dark main-nav">
			<div class="collapse navbar-collapse" id="navbarNavAltMarkup">
				<div class="navbar-nav">
					<a class="nav-item nav-link active" href="/">Home</a>
					<a class="nav-item nav-link" href="/public/html/conf.html">Configuration File</a>
					<a class="nav-item nav-link" href="/public/html/readme.html">Readme</a>
					<a class="nav-item nav-link" href="/media/subject.pdf">Subject</a>
					<a class="nav-item nav-link" href="https://datatracker.ietf.org/doc/html/rfc2016">RFC 2616</a>
				</div>
			</div>
		</nav>
		<section>

			<div id="mainContainer" class="center display-col">
				<div class="bloc display-row">
					<img id=schoolLogo src="/media/42logo.svg" alt="42logo">
					<div class="line"></div>
					<h1 class="title">WEBSERV</h1>
				</div>
				<div class="bloc description">
					<p><strong>Configuration</strong></p>
				</div>
				<div class="bloc display-row">
				</div>
			</div>

			<div id="presentation" style="width:60%; margin:auto; background-color: #bcbdbe; padding: 50px">



				<h3><strong><code>Error pages</code></strong></h3>
				<p>In case an error occured, <strong>webserv</strong> generates a default error page
				that will display the status code and the associated description.</p>

				<p>The following link will return error status codes as response with <strong>webserv</strong>'s default error page:</p>
				<ul>
					<li><a href="/static/forbidden.html">link to "/static/forbidden.html"</a></li>
				</ul>

				<p>If a webadmin wishes to set a <strong>custom error page</strong> for the website,
				it may do so using the "<strong><code>error_page</code></strong>"
				directive in the configuration file.</p>
				<p>For example, setting the following directive in a <strong><code>server</code></strong>
				block in the configuration file: </p>

				<pre><code>error_page 404 /path/to/error_page.html</code></pre>

				<p><strong>webserv</strong> will send the file "custom_error_page.html" as the body of the response, assuming it does exist.</p>

				<p>The following link will return a custom
				<strong>error page</strong> as set by the following
				<code>error_page</code> directive in the configuration:</p>
				<pre><code>error_page 404 /static/404.html</code></pre>
				<ul>
					<li><a href="/static/non-existent-file.html">link to "/static/non-existent-file.html"</a></li>
				</ul>
				

				<hr>

				<h3><strong><code>HTTP redirection</code></strong></h3>
				<p>You can set a HTTP redirection in a location block,
				<strong>webserv</strong> supports 301, 302 and 307 redirection codes.</p>
				<p>When a server responds to the client with one of those status,
				the <strong>client</strong> makes a new request for at an URI
				specified in the response in the "<code>Location</code>" header.</p>
				<p>The HTTP redirection in <strong>webserv</strong>
				is designed to redirect to another location in the hosted virtual server.</p>
				<p>Let's assume resources were initially in a location in the server file system,
				but were moved to another location for some reason.
				All the links pointing to the initial location should be modified accordingly.</p>
				<p>Setting a HTTP redirection in <strong>webserv</strong> is done using the
				"<code>return</code>" directive,
				with a redirection status code and the new location for the resources.</p>
				<code><pre>location /ancient-location/ {<br>	return 302 /new-location/<br>}</code></pre>
				<p>This way, the links pointing to the ancient location can remain unmodified:
				a request to the ancient location will be redirected to the new-location.</p>

				<p>When you click on the following link pointing to 
				<code><a href="/ancient-media-fld/holygraph.png">localhost:8000/ancient-media-fld/holygraph.png</a></code>:</p>
				<ul>
					<li><strong>webserv</strong> will answer "302 Moved Permanently" with a
						"<code>Location: /media/file.txt</code>" header</li>
					<li>browser should automatically renew the request to the URI specified in the
						"<code>Location</code>" header</li>
					<li><strong>webserv</strong> can then retrieve the resource at the new-location</li>
				</ul>



				<hr>
				<h3><strong><code>HTTP method limitation</code></strong></h3>
				<p>The tutorial pages you are reading are located in the following block in the configuration file:</p>
				<pre><code>location /static/ {<br>	root _PWD/website/srcs/public/static/<br>	limit_except GET<br>}</code></pre>
				<p>The <strong><code>limit_except</code></strong> allows you to setup the allowed HTTP method for the route.</p>
				<p>This setup makes it impossible to <code>DELETE</code> or <code>POST</code> something in this location.</p>
				<p>You can try it by executing the following in the terminal:</p>
				<pre><code>curl -v -X DELETE http://localhost:8000/static/config.html</code></pre>
				<p><strong>webserv</strong> should prevent the action from being performed and return a
				"<code>405 Method Not Allowed</code>" error.</p>



				
				<hr>
				<h3><strong><code>Body size limitation</code></strong></h3>
				<p>This website was configured to allow file upload up to a size of 1Mbyte.</p>
				<p>This was done using the <strong><code>client_max_body_size</code></strong>
				directive in the configuration file as following:</p>
				<pre><code>client_max_body_size 1m</code></pre>
				<p>Trying to upload any larger file should result in a
				"<code>413 Request Entity Too Large</code>" error.</p>
				<p>You can test this feature using the following in the terminal:</p>
				<pre><code>curl -v -X POST -T test_files/big_image.jpg http://localhost:8000/media</pre></code>
				

				<hr>
				<h3><strong><code>Default upload folder</code></strong></h3>
				<p>To setup a default upload folder for a route, use the
				<strong><code>upload_fld</code></strong> directive in a <code>location</code>
				block in the configuration file.</p>
				<p>We have setup a default upload folder for the "<code>/</code>" route, as following:</p>
				<pre><code>location / {<br>	root _PWD/website/srcs/<br>	upload_fld _PWD/website/srcs/media<br>}</code></pre>
				<p>This setup means you cannot POST something directly to the root route of the website.</p>
				<p>Trying to post something to "<code>/</code>" URI will automatically upload it to the <code>/media/</code> route.</p>
				<p>You can try it using the following in the terminal:</p>
				<pre><code>curl -v -X POST -T test_files/holygraph.png http://localhost:8000/</pre></code>
				<hr>

				<div class="d-flex justify-content-between">
					<a href="/static/delete.html">
						<button type="button" class="btn btn-light">
							Prv: DELETE
						</button>
					</a>
					<a href="/static/cgi.html">
						<button type="button" class="btn btn-light">
							Next: CGI
						</button>
					</a>
				</div>
			</div>
			<br>
			<div id="photoContainer" class="bloc display-row">
				<img src="/media/ellacroi.jpeg" title="ellacroi "alt="user">
				<img src="/media/axaidan.jpeg" title="axaidan" alt="user">
				<img src="/media/jboisser.jpeg" title="jboisser" alt="user">
			</div>
		</section>
	</body>
</html>
